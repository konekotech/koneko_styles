\setmainfont{CenturyOldstBT}
\setsansfont{Helvetica}
\setsansjfont{HiraginoSans}


% カスタムヘッダ
\usepackage{xcolor}
\usepackage{fancyhdr}

% カスタムページヘッダーの設定
\pagestyle{fancy}

\fancypagestyle{oreilly-style}{%
  \fancyhf{} % 既存のヘッダー/フッターをクリア
  \setlength{\topmargin}{-0.5in}

  \fancyhead[LE]{\setsansfont{Futura}\scalebox{0.8}[1.1]{\bf{\sf{\thepage}}}\setsansfont{Helvetica}\sf{\hspace{8mm}\textcolor{black}{\hspace{2mm}\rule[-0.8ex]{0.5mm}{0.7cm}}\hspace{2mm}\leftmark}}
  \fancyhead[RO]{\sf{\rightmark\hspace{2mm}\textcolor{black}{\hspace{2mm}\rule[-0.8ex]{0.5mm}{0.6cm}}\hspace{8mm}}\setsansfont{Futura}\scalebox{0.8}[1.1]{\bf{\sf{\thepage}}}\setsansfont{Helvetica}}
}


\renewcommand{\chaptermark}[1]{\markboth{\thechapter 章\space#1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection\space#1}{}}

%章番号とか
\setcounter{secnumdepth}{3} % この行をプリアンブルに追加
%
\usepackage{titlesec}


% chapterの見出しフォントを太字かつサンセリフ体に変更
\titleformat{\chapter}[display]
{\sffamily\HUGE\bfseries\raggedleft}
{\textcolor{gray}{\chaptertitlename\ \thechapter 章}}
{20pt}
{\HUGE}[\thispagestyle{oreilly-style}]
\titleformat*{\section}{\Large\bfseries\sffamily}
\titleformat*{\subsection}{\large\bfseries\sffamily}
\titleformat*{\subsubsection}{\large\sffamily}
\titlespacing{\chapter}{10pt}{15pt}{100pt}

%目次の変更
\renewcommand{\contentsname}{目　次}

%脚注のカスタマイズ
\renewcommand{\thefootnote}{\dagger\arabic{footnote}}


\newcommand{\oreillymaketitle}[1]{\maketitle\newpage\thispagestyle{customfooter}\vspace*{21cm}\noindent\copyright #1 All rights reserved.\\\\本書で使用するシステム名、製品名は、いずれも各社の商標、または登録商標です。\\なお、本文中では${}^{\rm{TM}}$、\textregistered、\copyright マークは省略している場合もあります。\newpage\pagestyle{oreilly-style}\pagenumbering{roman}\setcounter{page}{3}\setcounter{tocdepth}{2}\tableofcontents\clearpage\pagenumbering{arabic}\setcounter{page}{1}}